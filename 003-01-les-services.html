<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-02-05T08:27:01.736698"><title>Les services | Symfony support</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs","level":0,"title":"Objectifs","anchor":"#objectifs"},{"id":"d-finition","level":0,"title":"Définition","anchor":"#d-finition"},{"id":"un-exemple-plus-concret","level":0,"title":"Un exemple plus concret","anchor":"#un-exemple-plus-concret"},{"id":"configurer-un-service","level":0,"title":"Configurer un service","anchor":"#configurer-un-service"},{"id":"services-et-interfaces","level":0,"title":"Services et interfaces","anchor":"#services-et-interfaces"},{"id":"les-tags","level":0,"title":"Les tags","anchor":"#les-tags"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Les services | Symfony support"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Symfony support Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation//version 1/003-01-les-services.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Les services | Symfony support"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation//version 1/003-01-les-services.html#webpage",
    "url": "writerside-documentation//version 1/003-01-les-services.html",
    "name": "Les services | Symfony support",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Symfony support Help"
}</script><!-- End Schema.org --></head><body data-id="003-01-Les-services" data-main-title="Les services" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Symfony support version 1 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="003-01-Les-services" id="003-01-Les-services.md">Les services</h1><section class="chapter"><h2 id="objectifs" data-toc="objectifs">Objectifs</h2><ul class="list _bullet" id="n8b19_9"><li class="list__item" id="n8b19_10"><p>Identifier ce qu'est un service dans Symfony.</p></li><li class="list__item" id="n8b19_11"><p>Cr&eacute;er et utiliser un service.</p></li><li class="list__item" id="n8b19_12"><p>Identifier le r&ocirc;le de l'auto-configuration et de l'auto-injection (autowiring).</p></li><li class="list__item" id="n8b19_13"><p>Explorer les diff&eacute;rentes fa&ccedil;ons de param&eacute;trer un service</p></li></ul></section><section class="chapter"><h2 id="d-finition" data-toc="d-finition">D&eacute;finition</h2><p id="n8b19_14">Dans Symfony, les services sont des objets r&eacute;utilisables et configurables qui encapsulent une logique ou une fonctionnalit&eacute; sp&eacute;cifique. Ils permettent de structurer et d&rsquo;organiser le code de mani&egrave;re modulaire et maintenable. Symfony s'appuie sur un conteneur de services (ou conteneur d'injection de d&eacute;pendances) pour g&eacute;rer ces services.</p><section class="chapter"><h3 id="qu-est-ce-qu-un-service" data-toc="qu-est-ce-qu-un-service">Qu'est-ce-qu'un service</h3><p id="n8b19_19">Un service est simplement une classe qui accomplit une t&acirc;che sp&eacute;cifique, par exemple :</p><ul class="list _bullet" id="n8b19_20"><li class="list__item" id="n8b19_22"><p>Effectuer des calculs ou des transformations.</p></li><li class="list__item" id="n8b19_23"><p>Interagir avec une base de donn&eacute;es.</p></li><li class="list__item" id="n8b19_24"><p>Envoyer des emails.</p></li><li class="list__item" id="n8b19_25"><p>Effectuer des appels API externes.</p></li><li class="list__item" id="n8b19_26"><p>G&eacute;rer la s&eacute;curit&eacute;, etc.</p></li></ul><p id="n8b19_21">En fait dans Symfony tout est service et le simple fait de cr&eacute;er une classe dans le dossier <code class="code" id="n8b19_27">src</code> la transforme automatiquement en service.</p></section><section class="chapter"><h3 id="exemple" data-toc="exemple">Exemple</h3><p id="n8b19_28">Voici un service tr&egrave;s simple</p><p id="n8b19_29">Une interface</p><div class="code-block" data-lang="php">
// src/Service/GreetingInterface.php
namespace App\Service;

Interface GreetingInterface
{
    public function sayHello(string $name): string    
}
</div><p id="n8b19_31">Une classe</p><div class="code-block" data-lang="php">
// src/Service/GreetingService.php
namespace App\Service;

class GreetingService implements GreetingInterface
{
    public function sayHello(string $name): string
    {
        return &quot;Hello, $name!&quot;;
    }
}
</div><p id="n8b19_33">Et son utilisation dans un contr&ocirc;leur</p><div class="code-block" data-lang="php">
// src/Controller/HelloController.php
namespace App\Controller;

use App\Service\GreetingInterface;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Response;

class MyController extends AbstractController
{
    public function __construct(
    private GreetingInterface $greeter){}

    public function index(): Response
    {
        $message = $this-&gt;greeter-&gt;sayHello('Symfony');
        return new Response($message);
    }
}
</div><p id="n8b19_35">Ici l'injecteur de d&eacute;pendance de Symfony fait un tour de magie. Le simple fait de d&eacute;clarer la d&eacute;pendance dans le constructeur injecte automatiquement une instance du service.</p></section><section class="chapter"><h3 id="bonnes-pratiques" data-toc="bonnes-pratiques">Bonnes pratiques</h3><ul class="list _bullet" id="n8b19_36"><li class="list__item" id="n8b19_37"><p><span class="control" id="n8b19_40">Interface</span>: Pr&eacute;f&eacute;rer typer sur des interfaces si le service est susceptible de changer. Pour les composants de Symfony, toujours typer sur une interface.</p></li><li class="list__item" id="n8b19_38"><p><span class="control" id="n8b19_41">Modularit&eacute;</span>: D&eacute;porter la logique m&eacute;tier dans des services pour simplifier les contr&ocirc;leurs</p></li><li class="list__item" id="n8b19_39"><p><span class="control" id="n8b19_42">Autowiring</span>: Tirer parti de l'autowiring pour injecter les d&eacute;pendances. Cette fonctionnalit&eacute; est active pour toutes les classes, y compris les services eux-m&ecirc;mes.</p></li></ul></section><section class="chapter"><h3 id="commandes-utiles" data-toc="commandes-utiles">Commandes utiles</h3><p id="n8b19_43">Symfony propose des outils pour interagir avec les services :</p><p id="n8b19_44">Lister tous les services disponibles :</p><div class="code-block" data-lang="bash">
symfony console debug:container
</div><p id="n8b19_46">Rechercher un service sp&eacute;cifique :</p><div class="code-block" data-lang="bash">
php bin/console debug:container &lt;service_name&gt;
</div></section></section><section class="chapter"><h2 id="un-exemple-plus-concret" data-toc="un-exemple-plus-concret">Un exemple plus concret</h2><p id="n8b19_48">Un service d'envoi d'email</p><div class="code-block" data-lang="php">
// src/Service/EmailService.php
namespace App\Service;

use Symfony\Component\Mailer\MailerInterface;
use Symfony\Component\Mime\Email;

class EmailService
{
    private MailerInterface $mailer;

    public function __construct(MailerInterface $mailer)
    {
        $this-&gt;mailer = $mailer;
    }

    public function sendEmail(string $to, string $subject, string $content): void
    {
        $email = (new Email())
            -&gt;from('you@example.com')
            -&gt;to($to)
            -&gt;subject($subject)
            -&gt;text($content);

        $this-&gt;mailer-&gt;send($email);
    }
}
</div><p id="n8b19_50">Et son utilisation dans un contr&ocirc;leur, notons qu'ici, nous injectons la d&eacute;pendance dans la m&eacute;thode utilisatrice et non dans le constructeur.</p><div class="code-block" data-lang="php">
public function sendEmail(EmailService $emailService): Response
{
    $emailService-&gt;sendEmail(
        'test@example.com', 
        'Subject', 
        'Hello World!');
    return new Response('Email sent');
}
</div></section><section class="chapter"><h2 id="configurer-un-service" data-toc="configurer-un-service">Configurer un service</h2><p id="n8b19_52">L'injection automatique (autowiring) ne fonctionne que pour les classes ou les interfaces. Si nous souhaitons passer un param&egrave;tre scalaire au service, il faudra le configurer.</p><p id="n8b19_53">Les param&egrave;tres sont des constantes que nous pouvons d&eacute;finir de plusieurs fa&ccedil;ons :</p><ul class="list _bullet" id="n8b19_54"><li class="list__item" id="n8b19_59"><p>En tant que constante de classe dans le service.</p></li><li class="list__item" id="n8b19_60"><p>Dans la clef <code class="code" id="n8b19_61">parameters</code> de <code class="code" id="n8b19_62">config/services.yaml</code>.</p></li></ul><p id="n8b19_55">Si l'information ne doit pas &ecirc;tre partag&eacute;e par plusieurs services, nous opterons pour la premi&egrave;re solution.</p><section class="chapter"><h3 id="un-service-d-upload" data-toc="un-service-d-upload">Un service d'upload</h3><p id="n8b19_63">Ici le service d'upload a besoin de connaitre le chemin dans lequel d&eacute;placer le fichier. Ce chemin pourrait &ecirc;tre utilis&eacute; par d'autres services donc nous en ferons un param&egrave;tre.</p><div class="code-block" data-lang="yaml">
# config/services.yaml
parameters:
    app.upload_directory: '%kernel.project_dir%/public/uploads'
</div><p id="n8b19_65">Ensuite dans le service, nous utilisons un attribut PHP pour indiquer la valeur qui doit &ecirc;tre inject&eacute;e.</p><div class="code-block" data-lang="php">
// src/Service/FileUploader.php
namespace App\Service;

use Symfony\Component\HttpFoundation\File\UploadedFile;

class FileUploader
{
    private string $uploadDirectory;

    public function __construct(
        #[Autowire('%app.upload_directory%')]
        string $uploadDirectory)
    {
        $this-&gt;uploadDirectory = $uploadDirectory;
    }

    public function upload(UploadedFile $file): string
    {
        // Génération d'un nom de fichier unique
        $fileName = uniqid() . '.' . $file-&gt;guessExtension();

        // Déplacement du fichier dans le répertoire de téléchargement
        $file-&gt;move($this-&gt;uploadDirectory, $fileName);

        return $fileName;
    }
}
</div></section><section class="chapter"><h3 id="un-g-n-rateur-de-code-promo" data-toc="un-g-n-rateur-de-code-promo">Un g&eacute;n&eacute;rateur de code promo</h3><p id="n8b19_67">Ici, le pr&eacute;fixe du code promo est variable, plut&ocirc;t que de l'injecter dans le constructeur, on pr&eacute;f&eacute;rera donc d&eacute;finir sa valeur avec un setter.</p><div class="code-block" data-lang="php">
// src/Service/PromoCodeGenerator.php
namespace App\Service;

class PromoCodeGenerator
{
    private string $prefix = 'BLACKFRIDAY';

    public function setPrefix(string $prefix): self{
        $this-&gt;prefix = strtoupper($prefix);
    }

    public function generateCode(int $length = 8): string
    {
        $randomString = bin2hex(random_bytes($length / 2));
        return $this-&gt;prefix . '-' . $randomString;
    }
}
</div></section><section class="chapter"><h3 id="un-calculateur-de-frais-de-port" data-toc="un-calculateur-de-frais-de-port">Un calculateur de frais de port</h3><p id="n8b19_69">Ici le tarif de base de l'exp&eacute;dition est uniquement utilis&eacute; par ce service, inutile donc de l'injecter. Nous pourrions tout de m&ecirc;me le r&eacute;cup&eacute;rer soit en appellant la constante, soit en utilisant la m&eacute;thode <code class="code" id="n8b19_72">getBaseFee</code>.</p><p id="n8b19_70">Cet exemple est simplifi&eacute; pour les besoins de la d&eacute;monstration. Dans un cas r&eacute;&eacute;l, nous aurions sans doute besoin d'un autre service pour calculer le surco&ucirc;t de l'exp&eacute;dition &agrave; l'international.</p><div class="code-block" data-lang="php">
// src/Service/DeliveryService.php
namespace App\Service;

class DeliveryService
{
    // Définir une constante pour le tarif de base
    private const BASE_DELIVERY_FEE = 5.99;

    public function calculateFee(
        float $weight, 
        string $destination): float
    {
        // Exemple simple : les frais augmentent avec le poids et en fonction de la destination
        $extraFee = $destination === 'international' ? 15.00 : 0.00;

        return self::BASE_DELIVERY_FEE + ($weight * 0.50) + $extraFee;
    }

    public function getBaseFee(): float
    {
        return self::BASE_DELIVERY_FEE;
    }
}
</div></section></section><section class="chapter"><h2 id="services-et-interfaces" data-toc="services-et-interfaces">Services et interfaces</h2><p id="n8b19_73">Cr&eacute;er des interfaces pour les services dans Symfony n'est pas obligatoire, mais cela peut &ecirc;tre une bonne pratique dans certaines situations. Cela d&eacute;pend du contexte et des besoins de notre application. Voici un guide pour d&eacute;cider quand et pourquoi cr&eacute;er des interfaces pour nos services, ainsi que leurs avantages et inconv&eacute;nients.</p><section class="chapter"><h3 id="pourquoi-cr-er-des-interfaces-pour-les-services" data-toc="pourquoi-cr-er-des-interfaces-pour-les-services">Pourquoi cr&eacute;er des interfaces pour les services ?</h3><ol class="list _decimal" id="n8b19_77" type="1"><li class="list__item" id="n8b19_78"><p id="n8b19_82"><span class="control" id="n8b19_85">Respect du principe SOLID :</span></p><p id="n8b19_83">Le D de SOLID (Principe d'inversion des d&eacute;pendances) recommande de coder contre une interface plut&ocirc;t qu'une impl&eacute;mentation concr&egrave;te.</p><p id="n8b19_84">Cela rend notre code plus flexible et maintenable.</p></li><li class="list__item" id="n8b19_79"><p id="n8b19_86"><span class="control" id="n8b19_89">Facilit&eacute; de remplacement :</span></p><p id="n8b19_87">Une interface permet de remplacer facilement une impl&eacute;mentation par une autre.</p><p id="n8b19_88">Exemple : si nous souhaitons avoir plusieurs impl&eacute;mentations d&rsquo;un service (une pour un environnement local et une pour la production), une interface facilite le changement.</p></li><li class="list__item" id="n8b19_80"><p id="n8b19_90"><span class="control" id="n8b19_93">Tests unitaires :</span></p><p id="n8b19_91">Les interfaces permettent d'utiliser des mocks ou des stubs pendant les tests unitaires.</p><p id="n8b19_92">Exemple : simuler une d&eacute;pendance au lieu d'utiliser la vraie classe (comme une API ou un service externe).</p></li><li class="list__item" id="n8b19_81"><p id="n8b19_94"><span class="control" id="n8b19_96">Contrats clairs :</span></p><p id="n8b19_95">Une interface agit comme un contrat, d&eacute;finissant ce que le service doit faire sans r&eacute;v&eacute;ler comment il le fait. Cela aide &agrave; garder une s&eacute;paration claire entre la logique m&eacute;tier et les d&eacute;tails d'impl&eacute;mentation.</p></li></ol></section><section class="chapter"><h3 id="quand-cr-er-une-interface-pour-un-service" data-toc="quand-cr-er-une-interface-pour-un-service">Quand cr&eacute;er une interface pour un service ?</h3><section class="chapter"><h4 id="cas-o-il-est-pertinent" data-toc="cas-o-il-est-pertinent">Cas o&ugrave; il est pertinent :</h4><ol class="list _decimal" id="n8b19_99" type="1"><li class="list__item" id="n8b19_100"><p id="n8b19_104"><span class="control" id="n8b19_107">Services critiques :</span></p><p id="n8b19_105">Si le service est au c&oelig;ur de notre application et peut &eacute;voluer ou &ecirc;tre remplac&eacute;.</p><p id="n8b19_106">Exemple : services de paiement, services d&rsquo;envoi d&rsquo;email.</p></li><li class="list__item" id="n8b19_101"><p id="n8b19_108"><span class="control" id="n8b19_111">Services polymorphiques :</span></p><p id="n8b19_109">Si nous pr&eacute;voyons d'avoir plusieurs impl&eacute;mentations.</p><p id="n8b19_110">Exemple : un service de stockage pouvant utiliser des fichiers locaux ou un service cloud (S3, Azure Blob, etc.).</p></li><li class="list__item" id="n8b19_102"><p id="n8b19_112"><span class="control" id="n8b19_114">Travail en &eacute;quipe :</span></p><p id="n8b19_113">Les interfaces permettent &agrave; plusieurs d&eacute;veloppeurs de travailler ind&eacute;pendamment : un d&eacute;veloppeur peut impl&eacute;menter une interface pendant qu'un autre &eacute;crit le code qui utilise l'interface.</p></li><li class="list__item" id="n8b19_103"><p id="n8b19_115"><span class="control" id="n8b19_117">Projets &eacute;volutifs :</span></p><p id="n8b19_116">Si notre projet est complexe et susceptible d&rsquo;&eacute;voluer avec de nouvelles fonctionnalit&eacute;s ou int&eacute;grations.</p></li></ol></section><section class="chapter"><h4 id="cas-o-ce-n-est-pas-n-cessaire" data-toc="cas-o-ce-n-est-pas-n-cessaire">Cas o&ugrave; ce n&rsquo;est pas n&eacute;cessaire :</h4><ol class="list _decimal" id="n8b19_118" type="1"><li class="list__item" id="n8b19_119"><p id="n8b19_122"><span class="control" id="n8b19_125">Services simples :</span></p><p id="n8b19_123">Si le service effectue une t&acirc;che simple et stable, comme convertir une cha&icirc;ne ou traiter une liste.</p><p id="n8b19_124">Exemple : un service qui calcule des taux d'imposition pour une r&eacute;gion fixe.</p></li><li class="list__item" id="n8b19_120"><p id="n8b19_126"><span class="control" id="n8b19_128">Pas de remplacement pr&eacute;vu :</span></p><p id="n8b19_127">Si nous sommes certains qu&rsquo;il n&rsquo;y aura jamais besoin de plusieurs impl&eacute;mentations.</p></li><li class="list__item" id="n8b19_121"><p id="n8b19_129">Projets petits ou MVPs :</p><p id="n8b19_130">Si nous d&eacute;veloppons un projet simple ou un prototype, ajouter des interfaces peut &ecirc;tre un surco&ucirc;t inutile.</p></li></ol></section></section><section class="chapter"><h3 id="un-exemple" data-toc="un-exemple">Un exemple</h3><p id="n8b19_131"><span class="control" id="n8b19_139">L'interface</span></p><div class="code-block" data-lang="php">
// src/Service/NotifierInterface.php
namespace App\Service;

interface NotifierInterface
{
    public function send(string $recipient, string $subject, string $message): void;
}
</div><p id="n8b19_133"><span class="control" id="n8b19_140">Une impl&eacute;mentation</span></p><div class="code-block" data-lang="php">
// src/Service/EmailNotifier.php
namespace App\Service;

class EmailNotifier implements NotifierInterface
{
    public function send(string $recipient, string $subject, string $message): void
    {
        echo sprintf(&quot;Email envoyé à %s : [%s] %s&quot;, $recipient, $subject, $message);
    }
}
</div><p id="n8b19_135"><span class="control" id="n8b19_141">Une autre impl&eacute;mentation</span></p><div class="code-block" data-lang="php">
// src/Service/SmsNotifier.php
namespace App\Service;

class SmsNotifier implements NotifierInterface
{
    public function send(string $recipient, string $subject, string $message): void
    {
        echo sprintf(&quot;SMS envoyé à %s : [%s] %s&quot;, $recipient, $subject, $message);
    }
}
</div><p id="n8b19_137">Il faut pr&eacute;ciser l'impl&eacute;mentation qui sera inject&eacute;e autmatiquement quand on typera sur l'interface.</p><div class="code-block" data-lang="yaml">
# config/services.yaml
services:
   App\Service\NotifierInterface: '@App\Service\EmailNotifier'
</div></section></section><section class="chapter"><h2 id="les-tags" data-toc="les-tags">Les tags</h2><p id="n8b19_142">Les tags permettent d'ajouter des m&eacute;tadonn&eacute;es aux services et d'influencer leur comportement. Symfony utilise les tags pour des fonctionnalit&eacute;s comme les &eacute;v&eacute;nements, les commandes console, les &eacute;couteurs de requ&ecirc;tes, etc.</p><p id="n8b19_143">Symfony est un framework &eacute;v&eacute;nementiel et les tags permettent de brancher notre propre code sur les diff&eacute;rents &eacute;v&eacute;nements du traitement d'une requ&ecirc;te HTTP.</p><section class="chapter"><h3 id="exemple-une-commande-console" data-toc="exemple-une-commande-console">Exemple, une commande console</h3><p id="n8b19_147">Ici l'attribut <code class="code" id="n8b19_154">#[AsCommand(name: 'app:say-hello')]</code> d&eacute;clare notre classe comme une commande console.</p><div class="code-block" data-lang="php">
// dans src/Command

namespace App\Command;

use Symfony\Component\Console\Command\Command;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Output\OutputInterface;
use Symfony\Component\Console\Attribute\AsCommand;

#[AsCommand(name: 'app:say-hello')]
class HelloCommand extends Command
{
    protected function execute(InputInterface $input, OutputInterface $output): int
    {
        $output-&gt;writeln('Hello, Symfony!');
        return Command::SUCCESS;
    }
}
</div><p id="n8b19_149">Listons les commandes de Symfony</p><div class="code-block" data-lang="bash">
symfony console list
</div><p id="n8b19_151">La commande <code class="code" id="n8b19_155">app:say-hello</code> appara&icirc;t car elle est automatiquement tagg&eacute;e avec <code class="code" id="n8b19_156">console.command</code>.</p><p id="n8b19_152">Ex&eacute;cutons la commande :</p><div class="code-block" data-lang="bash">
symfony console app:say-hello
</div></section><section class="chapter"><h3 id="autre-exemple-injection-dans-la-requ-te" data-toc="autre-exemple-injection-dans-la-requ-te">Autre exemple, injection dans la requ&ecirc;te</h3><p id="n8b19_157">Ici nous ajoutons une information dans la requ&ecirc;te.</p><div class="code-block" data-lang="php">
// dans src/EventListener

namespace App\EventListener;

use Symfony\Component\HttpKernel\Event\RequestEvent;

class RequestListener
{
   #[AsEventListener(
      event: 'kernel.request', 
      priority: 100
    )]
    public function onKernelRequest(RequestEvent $event): void
    {
        $request = $event-&gt;getRequest();
        $request-&gt;attributes-&gt;set('_custom_attribute', 'Ceci est un attribut personnalisé.');
    }
}
</div><p id="n8b19_159">Dans le profiler, nous retrouvons notre attribut</p><figure id="n8b19_160"><img alt="CleanShot 2025-01-30 at 14.22.01@2x.png" src="images/CleanShot%202025-01-30%20at%2014.22.01%402x.png" title="CleanShot 2025-01-30 at 14.22.01@2x.png" width="2344" height="1492"></figure><p id="n8b19_161">Dans un contr&ocirc;leur, nous pouvons r&eacute;cup&eacute;rer cette valeur avec : <code class="code" id="n8b19_163">$request-&gt;get('_custom_attribute')</code></p><div class="code-block" data-lang="php">
class HomeController extends AbstractController
{
    #[Route('/', name: 'home')]
    public function index(Request $request)
    {
        dump(
            $request-&gt;get('_custom_attribute')
        );
        
        return $this-&gt;render('home/index.html.twig');
    }
}
</div></section><section class="chapter"><h3 id="liste-des-tags-et-des-attributs-php" data-toc="liste-des-tags-et-des-attributs-php">Liste des tags et des attributs PHP</h3><div class="table-wrapper"><table class="wide" id="n8b19_164"><thead><tr class="ijRowHead" id="n8b19_165"><th id="n8b19_179"><p><span class="control" id="n8b19_182">Attribut PHP</span></p></th><th id="n8b19_180"><p><span class="control" id="n8b19_183">Remplace le tag <code class="code" id="n8b19_184">services.yaml</code></span></p></th><th id="n8b19_181"><p><span class="control" id="n8b19_185">Description</span></p></th></tr></thead><tbody><tr id="n8b19_166"><td id="n8b19_186"><p><code class="code" id="n8b19_189">#[AsEventListener]</code></p></td><td id="n8b19_187"><p><code class="code" id="n8b19_190">kernel.event_listener</code></p></td><td id="n8b19_188"><p>Ajoute un &eacute;couteur d'&eacute;v&eacute;nement</p></td></tr><tr id="n8b19_167"><td id="n8b19_191"><p><code class="code" id="n8b19_194">#[AsEventListener]</code></p></td><td id="n8b19_192"><p><code class="code" id="n8b19_195">kernel.event_subscriber</code></p></td><td id="n8b19_193"><p>Ajoute un abonn&eacute; d'&eacute;v&eacute;nements (remplace <code class="code" id="n8b19_196">getSubscribedEvents()</code>)</p></td></tr><tr id="n8b19_168"><td id="n8b19_197"><p><code class="code" id="n8b19_200">#[AsCommand]</code></p></td><td id="n8b19_198"><p><code class="code" id="n8b19_201">console.command</code></p></td><td id="n8b19_199"><p>D&eacute;clare une commande console</p></td></tr><tr id="n8b19_169"><td id="n8b19_202"><p><code class="code" id="n8b19_205">#[AsValidator]</code></p></td><td id="n8b19_203"><p><code class="code" id="n8b19_206">validator.constraint_validator</code></p></td><td id="n8b19_204"><p>D&eacute;clare un validateur personnalis&eacute;</p></td></tr><tr id="n8b19_170"><td id="n8b19_207"><p><code class="code" id="n8b19_210">#[AsTaggedItem('twig.extension')]</code></p></td><td id="n8b19_208"><p><code class="code" id="n8b19_211">twig.extension</code></p></td><td id="n8b19_209"><p>Enregistre une extension Twig</p></td></tr><tr id="n8b19_171"><td id="n8b19_212"><p><code class="code" id="n8b19_215">#[AsTaggedItem('monolog.logger')]</code></p></td><td id="n8b19_213"><p><code class="code" id="n8b19_216">monolog.logger</code></p></td><td id="n8b19_214"><p>D&eacute;clare un logger personnalis&eacute;</p></td></tr><tr id="n8b19_172"><td id="n8b19_217"><p><code class="code" id="n8b19_220">#[AsTaggedItem('form.type')]</code></p></td><td id="n8b19_218"><p><code class="code" id="n8b19_221">form.type</code></p></td><td id="n8b19_219"><p>Enregistre un champ personnalis&eacute; pour les formulaires</p></td></tr><tr id="n8b19_173"><td id="n8b19_222"><p><code class="code" id="n8b19_225">#[AsTaggedItem('serializer.normalizer')]</code></p></td><td id="n8b19_223"><p><code class="code" id="n8b19_226">serializer.normalizer</code></p></td><td id="n8b19_224"><p>Enregistre un normalizer personnalis&eacute;</p></td></tr><tr id="n8b19_174"><td id="n8b19_227"><p><code class="code" id="n8b19_230">#[AsTaggedItem('serializer.encoder')]</code></p></td><td id="n8b19_228"><p><code class="code" id="n8b19_231">serializer.encoder</code></p></td><td id="n8b19_229"><p>Enregistre un encodeur personnalis&eacute;</p></td></tr><tr id="n8b19_175"><td id="n8b19_232"><p><code class="code" id="n8b19_235">#[AsTaggedItem('doctrine.event_listener')]</code></p></td><td id="n8b19_233"><p><code class="code" id="n8b19_236">doctrine.event_listener</code></p></td><td id="n8b19_234"><p>D&eacute;clare un &eacute;couteur d'&eacute;v&eacute;nements Doctrine</p></td></tr><tr id="n8b19_176"><td id="n8b19_237"><p><code class="code" id="n8b19_240">#[AsTaggedItem('doctrine.event_subscriber')]</code></p></td><td id="n8b19_238"><p><code class="code" id="n8b19_241">doctrine.event_subscriber</code></p></td><td id="n8b19_239"><p>D&eacute;clare un abonn&eacute; aux &eacute;v&eacute;nements Doctrine</p></td></tr><tr id="n8b19_177"><td id="n8b19_242"><p><code class="code" id="n8b19_245">#[AsTaggedItem('security.voter')]</code></p></td><td id="n8b19_243"><p><code class="code" id="n8b19_246">security.voter</code></p></td><td id="n8b19_244"><p>D&eacute;clare un voter de s&eacute;curit&eacute; personnalis&eacute;</p></td></tr><tr id="n8b19_178"><td id="n8b19_247"><p><code class="code" id="n8b19_250">#[IsGranted]</code></p></td><td id="n8b19_248"><p><code class="code" id="n8b19_251">security.is_granted</code></p></td><td id="n8b19_249"><p>V&eacute;rifie un r&ocirc;le avant d'ex&eacute;cuter une action</p></td></tr></tbody></table></div></section></section><div class="last-modified">Last modified: 05 février 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="001-routes.html" class="navigation-links__prev">Routes et contr&ocirc;leurs</a><a href="002-00-twig.html" class="navigation-links__next">Twig</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.js"></script></body></html>